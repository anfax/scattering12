!!!*************************************************************
! 文件/File: amat.f
! 由李皓(lihao,LIH_ao@outlook.com)创建/修改/分享
! Created/Modified/Shared by Li Hao (lihao,LIH_ao@outlook.com)
! 日期时间/Date Time: 2025-04-11 00:14:06
!*************************************************************

!!!*************************************************************
! 文件/File: amat.f
! 由李皓(lihao,LIH_ao@outlook.com)创建/修改/分享
! Created/Modified/Shared by Li Hao (lihao,LIH_ao@outlook.com)
! 日期时间/Date Time: 2025-04-10 23:45:42
!*************************************************************

      SUBROUTINE BCOEF
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : BCOEF CALCULATES (FOR A GIVEN RHO VALUE) THE EXPANSION
C             : COEFFICIENTS (TO FOURTH ORDER) OF THE S I'S IN TERMS
C             : OF THE DELTA R I'S.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             :
C OUTPUT      : THE EXPANSION COEFFICIENTS OF MINUS COSINE RHO BAR IN
C             : TERMS OF THE DELTA R I'S ARE OUTPUT IN COMMON CRCOEF
C             :
C             :




      REAL*8 A11,A33,A13,A31,A111,A133,A113,A311,A333,A313
C
      include 'molcul.h'
      include 'value.h'
      include 'crcoef.h'
      include 'bcoeff.h'

C
C
      A11=2.D0*RE12
      A13=0.D0
      A111=(V**2-SR**2*U13**2+2.D0*SR**2*U3*U1)/(V**2+2.D0*V*SR**2*
     1 U13+SR**4*U13**2)
      A133=(SR**2*U3**2*RE12**2)/((V**2+2.D0*V*SR**2*U13+SR**4*U13
     1 **2)*RE32**2)
      A113=(2.D0*SR**2*U13*U3*CR*RE12)/((V**2+2.D0*V*SR**2*U13+SR**4
     1 *U13**2)*RE32)
      A31=0.D0
      A33=2.D0*RE32
      A311=(SR**2*U1**2*RE32**2)/((V**2+2.D0*V*SR**2*U13+SR**4*U13
     1 **2)*RE12**2)
      A333=(V**2-SR**2*U13**2+2.D0*SR**2*U3*U1)/(V**2+2.D0*V*SR**2*
     1 U13+SR**4*U13**2)
      A313=(2.D0*SR**2*U13*U1*CR*RE32)/((V**2+2.D0*V*SR**2*U13+SR**4
     1 *U13**2)*RE12)
      B11=1.D0
      B13=0.D0
      B31=0.D0
      B33=1.D0
      B111=(-A111+1.D0)/(2.D0*RE12)
      B133=(-A133)/(2.D0*RE12)
      B113=(-A113)/(2.D0*RE12)
      B311=(-A311)/(2.D0*RE32)
      B333=(-A333+1.D0)/(2.D0*RE32)
      B313=(-A313)/(2.D0*RE32)
      B1111=(RE12*A113*A311+2.D0*A111**2*RE32-2.D0*A111*RE32)/(4.D0*
     1 RE12**2*RE32)
      B1333=(A133*(2.D0*RE12*A333-2.D0*RE12+A113*RE32))/(4.D0*RE12**2*
     1 RE32)
      B1113=(RE12*A113*A313+2.D0*RE12*A133*A311+3.D0*A111*A113*RE32-
     1 A113*RE32)/(4.D0*RE12**2*RE32)
      B1133=(RE12*A113*A333-RE12*A113+2.D0*RE12*A133*A313+2.D0*A111*
     1 A133*RE32+A113**2*RE32)/(4.D0*RE12**2*RE32)
      B3111=(A311*(RE12*A313+2.D0*A111*RE32-2.D0*RE32))/(4.D0*RE12*
     1 RE32**2)
      B3333=(2.D0*RE12*A333**2-2.D0*RE12*A333+A133*RE32*A313)/(4.D0*
     1 RE12*RE32**2)
      B3113=(2.D0*RE12*A311*A333+RE12*A313**2+A111*RE32*A313+2.D0*
     1 A113*RE32*A311-RE32*A313)/(4.D0*RE12*RE32**2)
      B3133=(3.D0*RE12*A313*A333-RE12*A313+A113*RE32*A313+2.D0*A133*
     1 RE32*A311)/(4.D0*RE12*RE32**2)
      B11111=(-RE12**2*A113*A311*A313-RE12**2*A133*A311**2-5.D0*
     1 RE12*A111*A113*RE32*A311+3.D0*RE12*A113*RE32*A311-5.D0*A111**
     1 3*RE32**2+6.D0*A111**2*RE32**2-A111*RE32**2)/(8.D0*RE12**3*
     1 RE32**2)
      B13333=(A133*(-5.D0*RE12**2*A333**2+6.D0*RE12**2*A333-RE12**2-
     1 3.D0*RE12*A113*RE32*A333+3.D0*RE12*A113*RE32
     1 -2.D0*RE12*A133*RE32
     1 *A313-A111*A133*RE32**2-A113**2*RE32**2))/(8.D0*RE12**3*
     1 RE32**2)
      B11113=(-2.D0*RE12**2*A113*A311*A333-RE12**2*A113*A313**2-4.D0
     1 *RE12**2*A133*A311*A313-4.D0*RE12*A111*A113*RE32*A313-8.D0*
     1 RE12*A111*A133*RE32*A311-4.D0*RE12*A113**2*RE32*A311+2.D0*
     1 RE12*A113*RE32*A313+4.D0*RE12*A133*RE32*A311-10.D0*A111**2*
     1 A113*RE32**2+6.D0*A111*A113*RE32**2)/(8.D0*RE12**3*RE32**2)
      B11333=(-2.D0*RE12**2*A113*A333**2+2.D0*RE12**2*A113*A333-8.D0*
     1 RE12**2*A133*A313*A333+4.D0*RE12**2*A133*A313-4.D0*RE12*A111*
     1 A133*RE32*A333+4.D0*RE12*A111*A133*RE32-2.D0*RE12*A113**2*
     1 RE32*A333+2.D0*RE12*A113**2*RE32-6.D0*RE12*A113*A133*RE32*
     1 A313-4.D0*RE12*A133**2*RE32*A311-6.D0*A111*A113*A133*RE32**2-
     1 A113**3*RE32**2)/(8.D0*RE12**3*RE32**2)
      B11133=(-3.D0*RE12**2*A113*A313*A333+RE12**2*A113*A313-6.D0*
     1 RE12**2*A133*A311*A333+2.D0*RE12**2*A133*A311-3.D0*RE12**2*
     1 A133*A313**2-3.D0*RE12*A111*A113*RE32*A333+3.D0*RE12*A111*
     1 A113*RE32-6.D0*RE12*A111*A133*RE32*A313-3.D0*RE12*A113**2*
     1 RE32*A313-9.D0*RE12*A113*A133*RE32*A311+RE12*A113*RE32*A333
     1 -RE12*A113*RE32+2.D0*RE12*A133*RE32*A313-6.D0*A111**2*A133*
     1 RE32**2-6.D0*A111*A113**2*RE32**2+2.D0*A111*A133*RE32**2+A113
     1 **2*RE32**2)/(8.D0*RE12**3*RE32**2)
      B31111=(A311*(-RE12**2*A311*A333-RE12**2*A313**2-3.D0*RE12*
     1 A111*RE32*A313-2.D0*RE12*A113*RE32*A311+3.D0*RE12*RE32*A313-
     1 5.D0*A111**2*RE32**2+6.D0*A111*RE32**2-RE32**2))/(8.D0*RE12**2*
     1 RE32**3)
      B33333=(-5.D0*RE12**2*A333**3+6.D0*RE12**2*A333**2-RE12**2*
     1 A333-5.D0*RE12*A133*RE32*A313*A333+3.D0*RE12*A133*RE32*A313-
     1 A113*A133*RE32**2*A313-A133**2*RE32**2*A311)/(8.D0*RE12**2*
     1 RE32**3)
      B31113=(-6.D0*RE12**2*A311*A313*A333-RE12**2*A313**3-4.D0*RE12
     1 *A111*RE32*A311*A333-2.D0*RE12*A111*RE32*A313**2-6.D0*RE12*
     1 A113*RE32*A311*A313-4.D0*RE12*A133*RE32*A311**2+4.D0*RE12*
     1 RE32*A311*A333+2.D0*RE12*RE32*A313**2-2.D0*A111**2*RE32**2*
     1 A313-8.D0*A111*A113*RE32**2*A311+2.D0*A111*RE32**2*A313+4.D0*
     1 A113*RE32**2*A311)/(8.D0*RE12**2*RE32**3)
      B31333=(-10.D0*RE12**2*A313*A333**2+6.D0*RE12**2*A313*A333-4.D0*
     1 RE12*A113*RE32*A313*A333+2.D0*RE12*A113*RE32*A313-8.D0*RE12*
     1 A133*RE32*A311*A333+4.D0*RE12*A133*RE32*A311-4.D0*RE12*A133*
     1 RE32*A313**2-2.D0*A111*A133*RE32**2*A313-A113**2*RE32**2*
     1 A313-4.D0*A113*A133*RE32**2*A311)/(8.D0*RE12**2*RE32**3)
      B31133=(-6.D0*RE12**2*A311*A333**2+2.D0*RE12**2*A311*A333-6.D0*
     1 RE12**2*A313**2*A333+RE12**2*A313**2-3.D0*RE12*A111*RE32*
     1 A313*A333+RE12*A111*RE32*A313-6.D0*RE12*A113*RE32*A311*A333
     1 +2.D0*RE12*A113*RE32*A311-3.D0*RE12*A113*RE32*A313**2-9.D0*RE12
     1 *A133*RE32*A311*A313+3.D0*RE12*RE32*A313*A333-RE12*RE32*
     1 A313-3.D0*A111*A113*RE32**2*A313-6.D0*A111*A133*RE32**2*A311-
     1 3.D0*A113**2*RE32**2*A311+A113*RE32**2*A313+2.D0*A133*RE32**2*
     1 A311)/(8.D0*RE12**2*RE32**3)
      END
C
C
      SUBROUTINE COSRB
      IMPLICIT REAL*8 (A-H,O-Z)
C             :
C DATE        : 24.04.1986
C AUTHOR      : PER JENSEN
C UPDATES     :
C LANGUAGE    : FORTRAN
C PURPOSE     : CALCULATION OF THE EXPANSION COEFFICIENTS OF COSINE RHO
C             : BAR IN TERMS OF THE DELTA R I'S.
C             : THE CODE IS GENERATED BY REDUCE.
C             :
C SUBPROGRAMS :
C      CALLED :
C             :
C INPUT       : RHO  INSTANTANEOUS VALUE OF THE BENDING COORDINATE
C             :
C OUTPUT      : THE EXPANSION COEFFICIENTS OF MINUS COSINE RHO BAR IN
C             : TERMS OF THE DELTA R I'S ARE OUTPUT IN COMMON CRCOEF
C             :
C             :
C
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      REAL*8 A11,A33,A13,A31,A111,A133,A113,A311,A333,A313,
     1      C11,C13,C211,C233,C213,
     2      Q1,Q3,Q11,Q33,Q13,Q111,Q333,Q113,Q133,Q1111,Q3333,
     3      Q1113,Q1333,Q1133
C
C

      include 'value.h'
      include 'bcoeff.h'
      include 'molcul.h'

C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      A11=2.D0*RE12
      A13=0.D0
      A111=(V**2-SR**2*U13**2+2.D0*SR**2*U3*U1)/(V**2+2.D0*V*SR**2*
     1 U13+SR**4*U13**2)
      A133=(SR**2*U3**2*RE12**2)/((V**2+2.D0*V*SR**2*U13+SR**4*U13
     1 **2)*RE32**2)
      A113=(2.D0*SR**2*U13*U3*CR*RE12)/((V**2+2.D0*V*SR**2*U13+SR**4
     1 *U13**2)*RE32)
      A31=0.D0
      A33=2.D0*RE32
      A311=(SR**2*U1**2*RE32**2)/((V**2+2.D0*V*SR**2*U13+SR**4*U13
     1 **2)*RE12**2)
      A333=(V**2-SR**2*U13**2+2.D0*SR**2*U3*U1)/(V**2+2.D0*V*SR**2*
     1 U13+SR**4*U13**2)
      A313=(2.D0*SR**2*U13*U1*CR*RE32)/((V**2+2.D0*V*SR**2*U13+SR**4
     1 *U13**2)*RE12)
      C11=((V*CR-SR**2*U1)*RE32)/(V+SR**2*U13)
      C13=((V*CR-SR**2*U3)*RE12)/(V+SR**2*U13)
      C211=(-(V+U13)*SR**2*U1*RE32)/((V**2+2.D0*V*SR**2*U13+SR**4*
     1 U13**2)*RE12)
      C233=(-(V+U13)*SR**2*U3*RE12)/((V**2+2.D0*V*SR**2*U13+SR**4*
     1 U13**2)*RE32)
      C213=((V**2+SR**2*U13**2+SR**2*U3*U1)*CR)/(V**2+2.D0*V*SR**2
     1 *U13+SR**4*U13**2)
      Q1=(-RE32*CR+B31*C13+B11*C11)/(RE12*RE32)
      Q3=(-RE12*CR+B33*C13+B13*C11)/(RE12*RE32)
      Q11=(RE12*(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11
     1 **2*C211)+RE32*CR-(B31*C13+B11*C11))/(RE12**2*RE32)
      Q33=(RE12*CR+RE32*(B333*C13+B33**2*C233+B33*B13*C213+B133*
     1 C11+B13**2*C211)-(B33*C13+B13*C11))/(RE12*RE32**2)
      Q13=(RE12*RE32*(B313*C13+2.D0*B33*B31*C233+B33*B11*C213+B31*
     1 B13*C213+B113*C11+2.D0*B13*B11*C211+CR)-RE12*(B31*C13+B11*
     1 C11)-RE32*(B33*C13+B13*C11))/(RE12**2*RE32**2)
      Q111=(RE12**2*(B3111*C13+2.D0*B311*B31*C233+B311*B11*C213+
     1 B31*B111*C213+B1111*C11+2.D0*B111*B11*C211)-RE12*(B311*C13+
     1 B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)-RE32*CR+
     1 B31*C13+B11*C11)/(RE12**3*RE32)
      Q333=(-RE12*CR+RE32**2*(B3333*C13+2.D0*B333*B33*C233+B333*
     1 B13*C213+B33*B133*C213+B1333*C11+2.D0*B133*B13*C211)-RE32*(
     1 B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13**2*C211)+
     1 B33*C13+B13*C11)/(RE12*RE32**3)
      Q113=(RE12**2*RE32*(B3113*C13+2.D0*B313*B31*C233+B313*B11*
     1 C213+2.D0*B311*B33*C233+B311*B13*C213+B33*B111*C213+B31*
     1 B113*C213+B1113*C11+2.D0*B113*B11*C211+2.D0*B111*B13*C211)-
     1 RE12**2*(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**
     1 2*C211)+RE12*RE32*(-B313*C13-2.D0*B33*B31*C233-B33*B11*C213
     1 -B31*B13*C213-B113*C11-2.D0*B13*B11*C211-CR)+RE12*(B31*C13+
     1 B11*C11)+RE32*(B33*C13+B13*C11))/(RE12**3*RE32**2)
      Q133=(RE12*RE32**2*(B3133*C13+2.D0*B313*B33*C233+B313*B13*
     1 C213+2.D0*B333*B31*C233+B333*B11*C213+B33*B113*C213+B31*
     1 B133*C213+B1133*C11+2.D0*B113*B13*C211+2.D0*B133*B11*C211)+
     1 RE12*RE32*(-B313*C13-2.D0*B33*B31*C233-B33*B11*C213-B31*B13
     1 *C213-B113*C11-2.D0*B13*B11*C211-CR)+RE12*(B31*C13+B11*C11)
     1 -RE32**2*(B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13
     1 **2*C211)+RE32*(B33*C13+B13*C11))/(RE12**2*RE32**3)
      Q1111=(RE12**3*(B31111*C13+2.D0*B3111*B31*C233+B3111*B11*
     1 C213+B311**2*C233+B311*B111*C213+B31*B1111*C213+B11111*
     1 C11+2.D0*B1111*B11*C211+B111**2*C211)+RE12**2*(-B3111*C13-
     1 2.D0*B311*B31*C233-B311*B11*C213-B31*B111*C213-B1111*C11-2.D0*
     1 B111*B11*C211)+RE12*(B311*C13+B31**2*C233+B31*B11*C213+
     1 B111*C11+B11**2*C211)+RE32*CR-(B31*C13+B11*C11))/(RE12**4
     1 *RE32)
      Q3333=(RE12*CR+RE32**3*(2.D0*B3333*B33*C233+B3333*B13*C213+
     1 B333**2*C233+B333*B133*C213+B33*B1333*C213+B13333*C11+2.D0*
     1 B1333*B13*C211+B133**2*C211+C13*B33333)+RE32**2*(-B3333*
     1 C13-2.D0*B333*B33*C233-B333*B13*C213-B33*B133*C213-B1333*
     1 C11-2.D0*B133*B13*C211)+RE32*(B333*C13+B33**2*C233+B33*B13*
     1 C213+B133*C11+B13**2*C211)-(B33*C13+B13*C11))/(RE12*RE32
     1 **4)
      Q1113=(RE12**3*RE32*(2.D0*B3113*B31*C233+B3113*B11*C213+2.D0*
     1 B3111*B33*C233+B3111*B13*C213+2.D0*B313*B311*C233+B313*B111
     1 *C213+B311*B113*C213+B33*B1111*C213+B31*B1113*C213+B11113
     1 *C11+2.D0*B1113*B11*C211+2.D0*B1111*B13*C211+2.D0*B113*B111*
     1 C211+C13*B31113)+RE12**3*(-B3111*C13-2.D0*B311*B31*C233-
     1 B311*B11*C213-B31*B111*C213-B1111*C11-2.D0*B111*B11*C211)+
     1 RE12**2*RE32*(-B3113*C13-2.D0*B313*B31*C233-B313*B11*C213-
     1 2.D0*B311*B33*C233-B311*B13*C213-B33*B111*C213-B31*B113*C213
     1 -B1113*C11-2.D0*B113*B11*C211-2.D0*B111*B13*C211)+RE12**2*(
     1 B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)+
     1 RE12*RE32*(B313*C13+2.D0*B33*B31*C233+B33*B11*C213+B31*B13*
     1 C213+B113*C11+2.D0*B13*B11*C211+CR)-RE12*(B31*C13+B11*C11)-
     1 RE32*(B33*C13+B13*C11))/(RE12**4*RE32**2)
      Q1333=(RE32**3*RE12*(2.D0*B1133*B13*C211+B1133*B33*C213+2.D0*
     1 B1333*B11*C211+B1333*B31*C213+2.D0*B113*B133*C211+B113*B333
     1 *C213+B133*B313*C213+B11*B3333*C213+B13*B3133*C213+B31333
     1 *C13+2.D0*B3133*B33*C233+2.D0*B3333*B31*C233+2.D0*B313*B333*
     1 C233+C11*B11333)+RE32**3*(-B1333*C11-2.D0*B133*B13*C211-
     1 B133*B33*C213-B13*B333*C213-B3333*C13-2.D0*B333*B33*C233)+
     1 RE32**2*RE12*(-B1133*C11-2.D0*B113*B13*C211-B113*B33*C213-
     1 2.D0*B133*B11*C211-B133*B31*C213-B11*B333*C213-B13*B313*C213
     1 -B3133*C13-2.D0*B313*B33*C233-2.D0*B333*B31*C233)+RE32**2*(
     1 B133*C11+B13**2*C211+B13*B33*C213+B333*C13+B33**2*C233)+
     1 RE32*RE12*(B113*C11+2.D0*B11*B13*C211+B11*B33*C213+B13*B31*
     1 C213+B313*C13+2.D0*B31*B33*C233+CR)-RE32*(B13*C11+B33*C13)-
     1 RE12*(B11*C11+B31*C13))/(RE32**4*RE12**2)
      Q1133=(RE12**2*RE32**2*(2.D0*B3133*B31*C233+B3133*B11*C213+
     1 2.D0*B3113*B33*C233+B3113*B13*C213+B313**2*C233+B313*B113*
     1 C213+2.D0*B333*B311*C233+B333*B111*C213+B311*B133*C213+B33*
     1 B1113*C213+B31*B1133*C213+B11133*C11+2.D0*B1133*B11*C211+2.D0
     1 *B1113*B13*C211+B113**2*C211+2.D0*B133*B111*C211+C13*B31133
     1 )+RE12**2*RE32*(-B3113*C13-2.D0*B313*B31*C233-B313*B11*C213
     1 -2.D0*B311*B33*C233-B311*B13*C213-B33*B111*C213-B31*B113*
     1 C213-B1113*C11-2.D0*B113*B11*C211-2.D0*B111*B13*C211)+RE12**2
     1 *(B311*C13+B31**2*C233+B31*B11*C213+B111*C11+B11**2*C211)
     1 +RE12*RE32**2*(-B3133*C13-2.D0*B313*B33*C233-B313*B13*C213-
     1 2.D0*B333*B31*C233-B333*B11*C213-B33*B113*C213-B31*B133*C213
     1 -B1133*C11-2.D0*B113*B13*C211-2.D0*B133*B11*C211)+RE12*RE32*(
     1 B313*C13+2.D0*B33*B31*C233+B33*B11*C213+B31*B13*C213+B113*
     1 C11+2.D0*B13*B11*C211+CR)-RE12*(B31*C13+B11*C11)+RE32**2*(
     1 B333*C13+B33**2*C233+B33*B13*C213+B133*C11+B13**2*C211)-
     1 RE32*(B33*C13+B13*C11))/(RE12**3*RE32**3)
      CR1=-Q1
      CR3=-Q3
      CR11=-Q11
      CR33=-Q33
      CR13=-Q13
      CR111=-Q111
      CR333=-Q333
      CR113=-Q113
      CR133=-Q133
      CR1111=-Q1111
      CR3333=-Q3333
      CR1113=-Q1113
      CR1333=-Q1333
      CR1133=-Q1133
      RETURN
      END
C
C


      SUBROUTINE  AMAT ( A1Y1,A1Z1,A2Y1, A2Z1, A3Y1, A3Z1,
     2           A1Y3,A1Z3,A2Y3,  A2Z3, A3Y3, A3Z3,
     5           YE1,ZE1,YE2,ZE2,YE3,ZE3)



      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : CALCULATION OF THE A MATRIX, ITS DERIVATIVES AND THE
C            : A VECTOR COMPONENTS AND THEIR DERIVATIVES.
C            : THE CODE IS GENERATED BY REDUCE.
C            :
C
C
      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
      REAL*8  A1Y1,A1Z1,A2Y1,A2Z1,A3Y1,A3Z1,
     2       A1Y3,A1Z3,A2Y3,A2Z3,A3Y3,A3Z3,
     5       YE1,ZE1,YE2,ZE2,YE3,ZE3

C
      include 'molcul.h'
      include 'value.h'
      include 'bcoeff.h'

C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      A1Y1=((M3+M2)*SRE*M2)/(SR**2*M1*M3+M*M2)
      A1Z1=(-(M3+M2)*CRE*M2)/(SR**2*M1*M3+M*M2)
      A2Y1=(-((M3+M2)*SRE+CR*SNE*M3)*M1)/(
     1 SR**2*M1*M3+M*M2)
      A2Z1=(((M3+M2)*CRE-CR*CSE*M3)*M1)/(
     1 SR**2*M1*M3+M*M2)
      A3Y1=(CR*SNE*M1*M2)/(SR**2*M1*M3+M*
     1 M2)
      A3Z1=(CR*CSE*M1*M2)/(SR**2*M1*M3+M*
     1 M2)
      A1Y3=(CR*SRE*M3*M2)/(SR**2*M1*M3+M*
     1 M2)
      A1Z3=(-CR*CRE*M3*M2)/(SR**2*M1*M3+M*
     1 M2)
      A2Y3=(-((M1+M2)*SNE+CR*SRE*M1)*M3)/(
     1 SR**2*M1*M3+M*M2)
      A2Z3=(-((M1+M2)*CSE-CR*CRE*M1)*M3)/(
     1 SR**2*M1*M3+M*M2)
      A3Y3=((M1+M2)*SNE*M2)/(SR**2*M1*M3+M*M2)
      A3Z3=((M1+M2)*CSE*M2)/(SR**2*M1*M3+M*M2)


      YE1=((M3+M2)*SRE*RE12-SNE*RE32*M3)/M
      YE2=(-(SRE*RE12*M1+SNE*RE32*M3))/M
      YE3=((M1+M2)*SNE*RE32-SRE*RE12*M1)/M
      ZE1=(-((M3+M2)*CRE*RE12+CSE*RE32*M3))/M
      ZE2=(CRE*RE12*M1-CSE*RE32*M3)/M
      ZE3=((M1+M2)*CSE*RE32+CRE*RE12*M1)/M

      RETURN
      END
C
C
      SUBROUTINE TRNSRY ( RCOEF , YCOEF )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 24.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : TRANSFORMATION OF A FOURTH ORDER POLYNOMIAL IN THE R
C            : SUB I'S TO A FOURTH ORDER POLYNOMIAL IN THE Y SUB I'S
C            : THE CODE IS GENERATED BY REDUCE.
C            :
C INPUT      : RCOEF(1:15) THE COEFFICIENTS OF A FOURTH ORDER POLYNOMIAL
C            :             IN THE DELTA R I'S.
C            :
C OUTPUT     : YCOEF(1:15) THE COEFFICIENTS OF THE CORRESPONDING
C            :             POLYNOMIAL IN THE Y I'S.
C            :

C
      REAL*8 RCOEF(15),YCOEF(15)
      REAL*8 FCR0,FCR1,FCR3,FCR11,FCR33,FCR13,
     1      FCR111,FCR333,FCR113,FCR133,
     2      FCR1111,FCR3333,FCR1113,FCR1333,FCR1133,
     3      Q0,Q1,Q3,Q11,Q33,Q13,
     4      Q111,Q333,Q113,Q133,
     5      Q1111,Q3333,Q1113,Q1333,Q1133

C
C
      include 'molcul.h'
      include 'value.h'
      include 'bcoeff.h'
      include 'crcoef.h'
C
C
C


      FCR0=RCOEF(1)
      FCR1=RCOEF(2)
      FCR3=RCOEF(3)
      FCR11=RCOEF(4)
      FCR33=RCOEF(5)
      FCR13=RCOEF(6)
      FCR111=RCOEF(7)
      FCR333=RCOEF(8)
      FCR113=RCOEF(9)
      FCR133=RCOEF(10)
      FCR1111=RCOEF(11)
      FCR3333=RCOEF(12)
      FCR1113=RCOEF(13)
      FCR1333=RCOEF(14)
      FCR1133=RCOEF(15)
      Q0=FCR0
      Q1=FCR1/AA1
      Q3=FCR3/AA3
      Q11=(2.D0*FCR11+FCR1*AA1)/(2.D0*AA1**2)
      Q33=(2.D0*FCR33+FCR3*AA3)/(2.D0*AA3**2)
      Q13=FCR13/(AA3*AA1)
      Q111=(3.D0*FCR111+3.D0*FCR11*AA1+FCR1*AA1**2)/(3.D0*AA1**3)
      Q333=(3.D0*FCR333+3.D0*FCR33*AA3+FCR3*AA3**2)/(3.D0*AA3**3)
      Q113=(2.D0*FCR113+FCR13*AA1)/(2.D0*AA3*AA1**2)
      Q133=(2.D0*FCR133+FCR13*AA3)/(2.D0*AA3**2*AA1)
      Q1111=(12.D0*FCR1111+18.D0*FCR111*AA1+11.D0*FCR11*AA1**2+3.D0*FCR1
     1 *AA1**3)/(12.D0*AA1**4)
      Q3333=(12.D0*FCR3333+18.D0*FCR333*AA3+11.D0*FCR33*AA3**2+3.D0*FCR3
     1 *AA3**3)/(12.D0*AA3**4)
      Q1113=(3.D0*FCR1113+3.D0*FCR113*AA1+FCR13*AA1**2)/(3.D0*AA3*AA1
     1 **3)
      Q1333=(3.D0*FCR1333+3.D0*FCR133*AA3+FCR13*AA3**2)/(3.D0*AA3**3*
     1 AA1)
      Q1133=(4.D0*FCR1133+2.D0*FCR133*AA1+2.D0*FCR113*AA3+FCR13*AA3*
     1 AA1)/(4.D0*AA3**2*AA1**2)
      YCOEF(1)=Q0
      YCOEF(2)=Q1
      YCOEF(3)=Q3
      YCOEF(4)=Q11
      YCOEF(5)=Q33
      YCOEF(6)=Q13
      YCOEF(7)=Q111
      YCOEF(8)=Q333
      YCOEF(9)=Q113
      YCOEF(10)=Q133
      YCOEF(11)=Q1111
      YCOEF(12)=Q3333
      YCOEF(13)=Q1113
      YCOEF(14)=Q1333
      YCOEF(15)=Q1133
      RETURN
      END
C
C
      SUBROUTINE TRNSSR ( XS , XR )
      IMPLICIT REAL*8 (A-H,O-Z)
C            :
C DATE       : 28.04.1986
C AUTHOR     : PER JENSEN
C UPDATES    :
C LANGUAGE   : FORTRAN
C PURPOSE    : TRANSFORMATION FROM A SECOND ORDER POLYNOMIAL IN THE
C            : S I'S TO A FOURTH ORDER POLYNOMIAL IN THE DELTA R I'S.D0
C            : THE CODE IS GENERATED BY REDUCE.
C            :
C

C

C

      REAL*8 CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C
      INTEGER V1 ,V2, V3 , V2P1,
     1        NTEST 
C
C
C
      REAL*8 XS(6),XR(15)
C
C
      include 'molcul.h'
      include 'value.h'
      include 'bcoeff.h'
C
C
      COMMON/CRCOEF/
     1      CR1,CR3,CR11,CR33,CR13,
     2      CR111,CR333,CR113,CR133,
     3      CR1111,CR3333,CR1113,CR1333,CR1133
C
C


      XR(1) = XS(1)
      XR(2)=B31*XS(3)+B11*XS(2)
      XR(3)=B33*XS(3)+B13*XS(2)
      XR(4)=
     1 B311*XS(3)+B31**2*XS(5)+B31*B11*XS(6)+B111*XS(2)+B11**2*XS(4)
      XR(5)=
     1 B333*XS(3)+B33**2*XS(5)+B33*B13*XS(6)+B133*XS(2)+B13**2*XS(4)
      XR(6)=
     1 B313*XS(3)+2.D0*B33*B31*XS(5)+B33*B11*XS(6)+B31*B13*XS(6)+
     2 B113*XS(2)+2.D0*B13*B11*XS(4)
      XR(7)=
     1 B3111*XS(3)+2.D0*B311*B31*XS(5)+B311*B11*XS(6)+B31*B111*
     2 XS(6)+B1111*XS(2)+2.D0*B111*B11*XS(4)
      XR(8)=
     1 B3333*XS(3)+2.D0*B333*B33*XS(5)+B333*B13*XS(6)+B33*B133*
     2 XS(6)+B1333*XS(2)+2.D0*B133*B13*XS(4)
      XR(9)=
     1 B3113*XS(3)+2.D0*B313*B31*XS(5)+B313*B11*XS(6)+2.D0*B311*B33*
     2 XS(5)+B311*B13*XS(6)+B33*B111*XS(6)+B31*B113*XS(6)+B1113*XS(2)+
     3 2.D0*B113*B11*XS(4)+2.D0*B111*B13*XS(4)
      XR(10)=
     1 B3133*XS(3)+2.D0*B313*B33*XS(5)+B313*B13*XS(6)+2.D0*B333*B31*
     2 XS(5)+B333*B11*XS(6)+B33*B113*XS(6)+B31*B133*XS(6)+B1133*XS(2)+
     3 2.D0*B113*B13*XS(4)+2.D0*B133*B11*XS(4)
      XR(11)=
     1 B31111*XS(3)+2.D0*B3111*B31*XS(5)+B3111*B11*XS(6)+B311**2*
     2 XS(5)+B311*B111*XS(6)+B31*B1111*XS(6)+B11111*XS(2)+2.D0*B1111*
     3 B11*XS(4)+B111**2*XS(4)
      XR(12)=
     1 2.D0*B3333*B33*XS(5)+B3333*B13*XS(6)+B333**2*XS(5)+B333*
     2 B133*XS(6)+B33*B1333*XS(6)+B13333*XS(2)+2.D0*B1333*B13*XS(4)+
     3 B133**2*XS(4)+XS(3)*B33333
      XR(13)=
     1 2.D0*B3113*B31*XS(5)+B3113*B11*XS(6)+2.D0*B3111*B33*XS(5)+
     2 B3111*B13*XS(6)+2.D0*B313*B311*XS(5)+B313*B111*XS(6)+B311*B113
     3 *XS(6)+B33*B1111*XS(6)+B31*B1113*XS(6)+B11113*XS(2)+2.D0*B1113*
     4 B11*XS(4)+2.D0*B1111*B13*XS(4)+2.D0*B113*B111*XS(4)+XS(3)*B31113
      XR(14)=
     1 2.D0*B3133*B33*XS(5)+B3133*B13*XS(6)+2.D0*B3333*B31*XS(5)+
     2 B3333*B11*XS(6)+2.D0*B313*B333*XS(5)+B313*B133*XS(6)+B333*B113
     3 *XS(6)+B33*B1133*XS(6)+B31*B1333*XS(6)+B11333*XS(2)+2.D0*B1133*
     4 B13*XS(4)+2.D0*B1333*B11*XS(4)+2.D0*B113*B133*XS(4)+XS(3)*B31333
      XR(15)=
     1 2.D0*B3133*B31*XS(5)+B3133*B11*XS(6)+2.D0*B3113*B33*XS(5)+
     2 B3113*B13*XS(6)+B313**2*XS(5)+B313*B113*XS(6)+2.D0*B333*B311*
     3 XS(5)+B333*B111*XS(6)+B311*B133*XS(6)+B33*B1113*XS(6)+B31*
     4 B1133*XS(6)+B11133*XS(2)+2.D0*B1133*B11*XS(4)+2.D0*B1113
     5 *B13*XS(4)+B113**2*XS(4)+2.D0*B133*B111*XS(4)
     6 +XS(3)*B31133
      RETURN
      END
