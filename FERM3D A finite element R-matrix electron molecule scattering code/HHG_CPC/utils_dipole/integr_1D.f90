!!!*************************************************************
! 文件/File: integr_1D.f90
! 由李皓(lihao,LIH_ao@outlook.com)创建/修改/分享
! Created/Modified/Shared by Li Hao (lihao,LIH_ao@outlook.com)
! 日期时间/Date Time: 2025-04-11 00:14:07
!*************************************************************

!!!*************************************************************
! 文件/File: integr_1D.f90
! 由李皓(lihao,LIH_ao@outlook.com)创建/修改/分享
! Created/Modified/Shared by Li Hao (lihao,LIH_ao@outlook.com)
! 日期时间/Date Time: 2025-04-10 23:45:43
!*************************************************************


SUBROUTINE qgaus(func,a,b,ss) 
use nrtype
REAL(kind=dbl) a,b,ss,func 
EXTERNAL func 
!Returns as ss the integral of the function func between a and b, by ten-point Gauss- Legendre
!integration: the function is evaluated exactly ten times at interior points in
!the range of integration. 
REAL(kind=dbl) dx,xm,xr,w(40),x(40)
INTEGER j
 SAVE w,x 

!data x/  0.38772417506050821933193444024624E-01&
!&,  0.11608407067525520848345128440802E+00&
!&,  0.19269758070137109971551685206515E+00&
!&,  0.26815218500725368114118434480860E+00&
!&,  0.34199409082575847300749248117919E+00&
!&,  0.41377920437160500152487974580371E+00&
!&,  0.48307580168617871290856657424482E+00&
!&,  0.54946712509512820207593130552952E+00&
!&,  0.61255388966798023795261245023069E+00&
!&,  0.67195668461417954837935451496149E+00&
!&,  0.72731825518992710328099645175493E+00&
!&,  0.77830565142651938769497154550650E+00&
!&,  0.82461223083331166319632023066610E+00&
!&,  0.86595950321225950382078180835462E+00&
!&,  0.90209880696887429672825333086849E+00&
!&,  0.93281280827867653336085216684521E+00&
!&,  0.95791681921379165580454099945276E+00&
!&,  0.97725994998377426266337028371290E+00&
!&,  0.99072623869945700645305435222137E+00&
!&,  0.99823770971055920034962270242059E+00/

!data w/0.77505947978424811263723962958326E-01&
!&,0.77039818164247965588307534283811E-01&
!&,0.76110361900626242371558075922495E-01&
!&,0.74723169057968264200189336261325E-01&
!&,0.72886582395804059060510683442519E-01&
!&,0.70611647391286779695483630855287E-01&
!&,0.67912045815233903825690108231923E-01&
!&,0.64804013456601038074554529566753E-01&
!&,0.61306242492928939166537996408400E-01&
!&,0.57439769099391551366617730910427E-01&
!&,0.53227846983936824354996479772260E-01&
!&,0.48695807635072232061434160448145E-01&
!&,0.43870908185673271991674686041717E-01&
!&,0.38782167974472017639972031290446E-01&
!&,0.33460195282547847392678183086411E-01&
!&,0.27937006980023401098489157507721E-01&
!&,0.22245849194166957261504324184209E-01&
!&,0.16421058381907888712863484882365E-01&
!&,0.10498284531152813614742171067278E-01&
!&,0.45212770985331912584717328781864E-02/

data x/&
&0.1951138325679399765435123D-01&
&,0.5850443715242066862899332D-01&
&,0.9740839844158459906327845D-01&
&,0.1361640228091438865592411D+00&
&,0.1747122918326468125593390D+00&
&,0.2129945028576661325723885D+00&
&,0.2509523583922721204931588D+00&
&,0.2885280548845118531091393D+00&
&,0.3256643707477019146191129D+00&
&,0.3623047534994873156190433D+00&
&,0.3983934058819692270243796D+00&
&,0.4338753708317560930623867D+00&
&,0.4686966151705444770360784D+00&
&,0.5028041118887849875936728D+00&
&,0.5361459208971319320198573D+00&
&,0.5686712681227097847254858D+00&
&,0.6003306228297517431547463D+00&
&,0.6310757730468719662479284D+00&
&,0.6608598989861198017359671D+00&
&,0.6896376443420276007712076D+00&
&,0.7173651853620998802540683D+00&
&,0.7440002975835972723165405D+00&
&,0.7695024201350413738656161D+00&
&,0.7938327175046054499486393D+00&
&,0.8169541386814634703711250D+00&
&,0.8388314735802552756166230D+00&
&,0.8594314066631110969771921D+00&
&,0.8787225676782138287037733D+00&
&,0.8966755794387706831943241D+00&
&,0.9132631025717576541647337D+00&
&,0.9284598771724457959530460D+00&
&,0.9422427613098726747522660D+00&
&,0.9545907663436349054934815D+00&
&,0.9654850890437992514522732D+00&
&,0.9749091405857277933856452D+00&
&,0.9828485727386290704182880D+00&
&,0.9892913024997555310265032D+00&
&,0.9942275409656882778920635D+00&
&,0.9976498643982376888994942D+00&
&,0.9995538226516306298800805D+00/













data w/&
&0.3901781365630665481128044D-01&
&,0.3895839596276953119862552D-01&
&,0.3883965105905196893177418D-01&
&,0.3866175977407646332707711D-01&
&,0.3842499300695942318521244D-01&
&,0.3812971131447763834420679D-01&
&,0.3777636436200139748977498D-01&
&,0.3736549023873049002670538D-01&
&,0.3689771463827600883915100D-01&
&,0.3637374990583597804396499D-01&
&,0.3579439395341605460286159D-01&
&,0.3516052904474759349552659D-01&
&,0.3447312045175392879436423D-01&
&,0.3373321498461152281667516D-01&
&,0.3294193939764540138283618D-01&
&,0.3210049867348777314805649D-01&
&,0.3121017418811470164244287D-01&
&,0.3027232175955798066122001D-01&
&,0.2928836958326784769276759D-01&
&,0.2825981605727686239675320D-01&
&,0.2718822750048638067441871D-01&
&,0.2607523576756511790296874D-01&
&,0.2492253576411549110511785D-01&
&,0.2373188286593010129319252D-01&
&,0.2250509024633246192622159D-01&
&,0.2124402611578200638871074D-01&
&,0.1995061087814199892889193D-01&
&,0.1862681420829903142873541D-01&
&,0.1727465205626930635858421D-01&
&,0.1589618358372568804490291D-01&
&,0.1449350804050907611696207D-01&
&,0.1306876159240133929378683D-01&
&,0.1162411412079782691646677D-01&
&,0.1016176604110306452083185D-01&
&,0.8683945269260858426409452D-02&
&,0.7192904768117312752675571D-02&
&,0.5690922451403198649269107D-02&
&,0.4180313124694895236739304D-02&
&,0.2663533589512681669293535D-02&
&,0.1144950003186941534544170D-02/









!  data w/.295524224714753,.269266719309996,.219086362515982,.149451349150581,.066671344308688/
!  data x/.148874338981631,.433339534129247,.679409568299024,.865063366688985,.973906528517172/
xm=0.5*(b+a)
xr=0.5*(b-a) 
ss=0
do  j=1,40
dx=xr*x(j)
ss=ss+w(j)*(func(xm+dx)+func(xm-dx)) 
enddo 
 ss=xr*ss 
return 
END
